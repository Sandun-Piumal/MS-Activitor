<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Home System</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body class="light-theme">
    <!-- Skip to main content for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <div class="container">
        <!-- Header Section -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-home"></i>
                    <h1>Smart Home System</h1>
                </div>
                <div class="connection-info">
                    <div class="status-indicators">
                        <div class="status-item">
                            <span class="status-label">Connection:</span>
                            <span id="connection-status" class="status offline">
                                <span class="connection-dot disconnected"></span>
                                <i class="fas fa-wifi"></i> Disconnected
                            </span>
                        </div>
                        <div class="status-item">
                            <span class="status-label">Security:</span>
                            <span id="security-status" class="status-active">
                                <i class="fas fa-shield-alt"></i> Active
                            </span>
                        </div>
                    </div>
                    <div class="datetime">
                        <div id="time-display" class="time">00:00:00</div>
                        <div id="date-display" class="date">January 1, 2024</div>
                    </div>
                    <div class="control-buttons-small">
                        <button class="btn btn-info" onclick="manualRefresh()" title="Refresh Data (F5)">
                            <i class="fas fa-sync-alt"></i> Refresh
                        </button>
                        <button class="btn btn-outline" onclick="openSettings()" title="Settings">
                            <i class="fas fa-cog"></i> Settings
                        </button>
                        <button class="btn btn-outline theme-toggle" onclick="toggleTheme()" title="Toggle Dark/Light Mode">
                            <i class="fas fa-moon" id="theme-icon"></i>
                            <span id="theme-text">Dark</span>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Dashboard -->
        <main class="dashboard" id="main-content">
            <!-- Left Sidebar - Quick Controls -->
            <aside class="sidebar">
                <!-- System Overview Card -->
                <div class="card overview-card">
                    <div class="card-header">
                        <i class="fas fa-tachometer-alt"></i>
                        <h3>System Overview</h3>
                    </div>
                    <div class="card-content">
                        <div class="overview-item">
                            <span class="label">Battery Level</span>
                            <div class="progress-container">
                                <div class="progress-bar">
                                    <div id="battery-level" class="progress-fill battery" style="width: 85%"></div>
                                </div>
                                <span id="battery-text" class="value">85%</span>
                            </div>
                        </div>
                        <div class="overview-item">
                            <span class="label">Water Tank</span>
                            <div class="progress-container">
                                <div class="progress-bar">
                                    <div id="water-level" class="progress-fill water" style="width: 70%"></div>
                                </div>
                                <span id="water-text" class="value">70%</span>
                            </div>
                        </div>
                        <div class="overview-item">
                            <span class="label">Temperature</span>
                            <span id="temperature" class="value">25Â°C</span>
                        </div>
                        <div class="overview-item">
                            <span class="label">Humidity</span>
                            <span id="humidity" class="value">60%</span>
                        </div>
                        <div class="overview-item">
                            <span class="label">Last Update</span>
                            <span id="last-update" class="value">Just now</span>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions Card -->
                <div class="card quick-actions-card">
                    <div class="card-header">
                        <i class="fas fa-bolt"></i>
                        <h3>Quick Actions</h3>
                    </div>
                    <div class="card-content">
                        <div class="action-group">
                            <button class="btn btn-primary btn-block" onclick="controlAllLights(true)">
                                <i class="fas fa-lightbulb"></i> All Lights ON
                            </button>
                            <button class="btn btn-secondary btn-block" onclick="controlAllLights(false)">
                                <i class="fas fa-lightbulb"></i> All Lights OFF
                            </button>
                        </div>
                        <div class="action-group">
                            <button class="btn btn-success btn-block" onclick="setSecuritySystem(true)">
                                <i class="fas fa-shield-alt"></i> Enable Security
                            </button>
                            <button class="btn btn-warning btn-block" onclick="setSecuritySystem(false)">
                                <i class="fas fa-shield-alt"></i> Disable Security
                            </button>
                        </div>
                        <div class="action-group">
                            <button class="btn btn-info btn-block" onclick="testBuzzer()">
                                <i class="fas fa-bell"></i> Test Buzzer
                            </button>
                            <button class="btn btn-danger btn-block" onclick="stopAlarm()" id="stop-alarm-btn">
                                <i class="fas fa-bell-slash"></i> Stop Alarm
                            </button>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Main Content Area -->
            <section class="main-content">
                <!-- Gate & Garage & Door Control Row -->
                <div class="card-row">
                    <!-- Gate Control Card -->
                    <div class="card control-card">
                        <div class="card-header">
                            <i class="fas fa-gate"></i>
                            <h3>Gate Control</h3>
                        </div>
                        <div class="card-content">
                            <div class="status-display">
                                <span class="label">Status:</span>
                                <span id="gate-status" class="status-badge status-closed">Closed</span>
                            </div>
                            <div class="control-buttons">
                                <button class="btn btn-success" onclick="controlGate()">
                                    <i class="fas fa-door-open"></i> Open Gate
                                </button>
                            </div>
                            <div class="last-update">RFID access enabled</div>
                        </div>
                    </div>

                    <!-- Garage Control Card -->
                    <div class="card control-card">
                        <div class="card-header">
                            <i class="fas fa-warehouse"></i>
                            <h3>Garage Door</h3>
                        </div>
                        <div class="card-content">
                            <div class="status-display">
                                <span class="label">Status:</span>
                                <span id="garage-status" class="status-badge status-closed">Closed</span>
                            </div>
                            <div class="status-display">
                                <span class="label">Distance:</span>
                                <span id="ultrasonic-distance" class="value">0 cm</span>
                            </div>
                            <div class="control-buttons">
                                <button class="btn btn-success" onclick="openGarage()">
                                    <i class="fas fa-arrow-up"></i> Open
                                </button>
                                <button class="btn btn-danger" onclick="closeGarage()">
                                    <i class="fas fa-arrow-down"></i> Close
                                </button>
                            </div>
                            <div class="mode-control">
                                <label class="switch">
                                    <input type="checkbox" id="garage-mode-toggle" onchange="setGarageMode(this.checked)" checked>
                                    <span class="slider"></span>
                                </label>
                                <span>Auto Mode</span>
                            </div>
                        </div>
                    </div>

                    <!-- Main Door Control Card -->
                    <div class="card control-card">
                        <div class="card-header">
                            <i class="fas fa-door-closed"></i>
                            <h3>Main Door Control</h3>
                        </div>
                        <div class="card-content">
                            <div class="status-display">
                                <span class="label">Status:</span>
                                <span id="main-door-status" class="status-badge status-closed">Closed</span>
                            </div>
                            <div class="status-display">
                                <span class="label">Lock:</span>
                                <span id="door-lock-status" class="status-badge status-locked">Locked</span>
                            </div>
                            <div class="control-buttons">
                                <button class="btn btn-success" onclick="openMainDoor()">
                                    <i class="fas fa-door-open"></i> Open Door
                                </button>
                                <button class="btn btn-danger" onclick="closeMainDoor()">
                                    <i class="fas fa-door-closed"></i> Close Door
                                </button>
                                <button class="btn btn-warning" onclick="toggleDoorLock()">
                                    <i class="fas fa-lock"></i> Toggle Lock
                                </button>
                            </div>
                            <div class="rfid-info">
                                <small><i class="fas fa-id-card"></i> RFID access enabled</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Lighting Control Card -->
                <div class="card lighting-card">
                    <div class="card-header">
                        <i class="fas fa-lightbulb"></i>
                        <h3>Lighting Control</h3>
                    </div>
                    <div class="card-content">
                        <div class="light-grid">
                            <div class="light-item">
                                <span class="light-label">LED 1 - Living Room</span>
                                <label class="switch">
                                    <input type="checkbox" id="led-1" onchange="controlLED(1, this.checked)">
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="light-item">
                                <span class="light-label">LED 2 - Kitchen</span>
                                <label class="switch">
                                    <input type="checkbox" id="led-2" onchange="controlLED(2, this.checked)">
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="light-item">
                                <span class="light-label">LED 3 - Bedroom</span>
                                <label class="switch">
                                    <input type="checkbox" id="led-3" onchange="controlLED(3, this.checked)">
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="light-item">
                                <span class="light-label">LED 4 - Garden</span>
                                <label class="switch">
                                    <input type="checkbox" id="led-4" onchange="controlLED(4, this.checked)">
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="light-item">
                                <span class="light-label">LED 5 - Garage</span>
                                <label class="switch">
                                    <input type="checkbox" id="led-5" onchange="controlLED(5, this.checked)">
                                    <span class="slider"></span>
                                </label>
                            </div>
                            <div class="light-item">
                                <span class="light-label">LED 6 - Security</span>
                                <label class="switch">
                                    <input type="checkbox" id="led-6" onchange="controlLED(6, this.checked)">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sensors & Environment Row -->
                <div class="card-row">
                    <!-- Climate Control Card -->
                    <div class="card sensor-card">
                        <div class="card-header">
                            <i class="fas fa-temperature-high"></i>
                            <h3>Climate Control</h3>
                        </div>
                        <div class="card-content">
                            <div class="sensor-reading">
                                <i class="fas fa-thermometer-half"></i>
                                <div class="reading-value">
                                    <span id="temperature-display">25Â°C</span>
                                    <span class="reading-label">Temperature</span>
                                </div>
                            </div>
                            <div class="sensor-reading">
                                <i class="fas fa-tint"></i>
                                <div class="reading-value">
                                    <span id="humidity-display">60%</span>
                                    <span class="reading-label">Humidity</span>
                                </div>
                            </div>
                            <div class="status-display">
                                <span class="label">Fan Status:</span>
                                <span id="fan-status" class="status-badge status-off">OFF</span>
                            </div>
                            <div class="status-display">
                                <span class="label">Motion:</span>
                                <span id="motion-status" class="status-badge status-off">No Motion</span>
                            </div>
                        </div>
                    </div>

                    <!-- Water & Rain Card -->
                    <div class="card sensor-card">
                        <div class="card-header">
                            <i class="fas fa-tint"></i>
                            <h3>Water & Rain</h3>
                        </div>
                        <div class="card-content">
                            <div class="sensor-reading">
                                <i class="fas fa-water"></i>
                                <div class="reading-value">
                                    <span id="water-level-display">70%</span>
                                    <span class="reading-label">Water Level</span>
                                </div>
                            </div>
                            <div class="sensor-reading">
                                <i class="fas fa-cloud-rain"></i>
                                <div class="reading-value">
                                    <span id="rain-status" class="status-dry">No Rain</span>
                                    <span class="reading-label">Rain Status</span>
                                </div>
                            </div>
                            <div class="status-display">
                                <span class="label">Curtains:</span>
                                <span id="curtain-status" class="value">Outside</span>
                            </div>
                            <div class="status-display">
                                <span class="label">Solar Panel:</span>
                                <span id="solar-angle" class="value">90Â°</span>
                            </div>
                        </div>
                    </div>

                    <!-- Gas & Security Card -->
                    <div class="card sensor-card">
                        <div class="card-header">
                            <i class="fas fa-wind"></i>
                            <h3>Gas & Security</h3>
                        </div>
                        <div class="card-content">
                            <div class="sensor-reading">
                                <i class="fas fa-gas-pump"></i>
                                <div class="reading-value">
                                    <span id="gas-status" class="status-safe">Safe</span>
                                    <span class="reading-label">Gas Status</span>
                                </div>
                            </div>
                            <div class="sensor-reading">
                                <i class="fas fa-bell"></i>
                                <div class="reading-value">
                                    <span id="alarm-status" class="status-safe">Inactive</span>
                                    <span class="reading-label">Alarm Status</span>
                                </div>
                            </div>
                            <div class="status-display">
                                <span class="label">Laser Security:</span>
                                <span id="laser-status" class="status-badge status-on">Active</span>
                            </div>
                            <div class="control-buttons">
                                <button class="btn btn-warning btn-block" onclick="testBuzzer()">
                                    <i class="fas fa-bell"></i> Test Buzzer
                                </button>
                                <button class="btn btn-danger btn-block" onclick="stopAlarm()" id="stop-alarm-main-btn" style="display:none;">
                                    <i class="fas fa-bell-slash"></i> Stop Alarm
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Alerts Panel -->
                <div class="card alert-card" id="alert-panel">
                    <div class="card-header">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h3>System Alerts & Notifications</h3>
                    </div>
                    <div class="card-content">
                        <div id="alert-content" class="alert-content">
                            <div class="alert-item info">
                                <i class="fas fa-info-circle"></i>
                                <span>System initialized and running normally</span>
                            </div>
                            <div class="alert-item info">
                                <i class="fas fa-wifi"></i>
                                <span>Connect to ESP32 to start monitoring</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <span>Smart Home System v2.0 â¢ Real-time Monitoring</span>
                <span>Connected to: <span id="esp-ip">192.168.1.100</span></span>
                <span id="connection-stats">Theme: <span id="current-theme">Light</span></span>
            </div>
        </footer>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-cog"></i> ESP32 Connection Settings</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="esp32-ip">ESP32 IP Address:</label>
                    <input type="text" id="esp32-ip" placeholder="192.168.1.100" class="form-input">
                    <small>Enter the IP address shown in ESP32 Serial Monitor</small>
                </div>
                <div class="form-group">
                    <label for="update-interval">Update Interval (seconds):</label>
                    <input type="number" id="update-interval" value="2" min="1" max="10" class="form-input">
                    <small>How often to refresh data from ESP32 (1-10 seconds)</small>
                </div>
                <div class="form-group">
                    <label>Theme Settings:</label>
                    <div class="theme-options">
                        <label class="theme-option">
                            <input type="radio" name="theme" value="light" checked onchange="setTheme('light')">
                            <span class="theme-checkmark"></span>
                            Light Theme
                        </label>
                        <label class="theme-option">
                            <input type="radio" name="theme" value="dark" onchange="setTheme('dark')">
                            <span class="theme-checkmark"></span>
                            Dark Theme
                        </label>
                        <label class="theme-option">
                            <input type="radio" name="theme" value="auto" onchange="setTheme('auto')">
                            <span class="theme-checkmark"></span>
                            Auto (System)
                        </label>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeSettings()">
                    <i class="fas fa-times"></i> Cancel
                </button>
                <button class="btn btn-primary" onclick="saveSettings()">
                    <i class="fas fa-save"></i> Save Settings
                </button>
                <button class="btn btn-info" onclick="testConnection()">
                    <i class="fas fa-plug"></i> Test Connection
                </button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>